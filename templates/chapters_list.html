{% for chapter in chapters %}
<div class="chapter-item">
    <a href="#" 
       hx-get="/api/stories/{{ story_id }}/chapters/{{ chapter.chapter_number }}"
       hx-target="#chapter-content"
       class="chapter-link">
        Chapter {{ chapter.chapter_number }}
    </a>
</div>
{% endfor %}

{% if chapters|length < num_chapters %}
<div class="chapter-item">
    <button hx-post="/api/stories/{{ story_id }}/chapters"
            hx-vals='{"chapter_number": {{ chapters|length + 1 }}}'
            hx-target="#chapter-content"
            class="generate-chapter-btn"
            _="on htmx:afterOnLoad 
               wait 10ms
               fetch /api/stories/{{ story_id }}/chapters-list
               put the result into .chapters-list">
        <span class="button-text">Generate Chapter {{ chapters|length + 1 }}</span>
        <div class="loading-indicator htmx-indicator">
            <div class="spinner"></div>
            <span>Generating...</span>
        </div>
    </button>
</div>
{% endif %} 